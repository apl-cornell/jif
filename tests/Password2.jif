class Password2 authority(root) {
    private String{*!:*}[]{*!:*} names;
    private String{root:;*!:*}[]{*!:*} passwords;

    public boolean{user; password} check(String user, String password) 
	where authority(root)
    {
	boolean match = false;

	try {
	    for (int i = 0; i < names.length; i++) {
		if (names[i] == user && passwords[i] == password) {
		    match = true;
		    break;
		}
	    }
	}
	catch (NullPointerException e) {
	}
	catch (ArrayIndexOutOfBoundsException e) {
	}

	return declassify(match, {user; password; this});
    }
}
